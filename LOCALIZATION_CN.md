# Obsidian Git 插件 - 汉化详情

## 📋 概述

此 Obsidian Git 插件已完成**完整的国际化（i18n）实现**，现在支持简体中文界面。

## 已完成的工作

### 1. 国际化系统架构

- ✅ 创建了完整的 i18n 系统 (`src/i18n/`)
- ✅ 实现了自动语言检测功能
- ✅ 支持变量插值和嵌套键
- ✅ 提供了灵活的 API 接口

### 2. 语言文件

- ✅ 英文翻译文件 (`src/i18n/locales/en.ts`)
- ✅ 简体中文翻译文件 (`src/i18n/locales/zh-cn.ts`)
- ✅ 支持多个语言代码别名 (zh, zh-cn, zh-CN)

### 3. 已翻译的内容

以下内容已完成翻译：

#### 命令 (Commands)
- 所有 Git 命令（编辑、打开视图、暂存、提交、推送、拉取等）
- 分支操作命令
- 差异块（Hunk）相关命令
- GitHub 集成命令

#### 通知消息 (Notices)
- Git 操作成功/失败消息
- 文件统计信息
- 冲突提示
- 网络错误提示

#### 对话框 (Modals)
- 提交消息对话框
- 分支选择对话框
- 远程仓库配置
- 克隆仓库对话框
- 放弃更改确认

#### 设置页面 (Settings)
- 自动化设置
- 提交消息配置
- 拉取/推送设置
- 差异块管理
- 行作者信息
- 历史记录视图
- 源代码管理视图
- 其他选项

#### 用户界面
- 文件菜单项
- 视图标题和按钮
- 状态栏文本
- 冲突文件提示

### 4. 核心文件修改

以下核心文件已完成国际化集成：

- ✅ `src/main.ts` - 主插件文件
- ✅ `src/commands.ts` - 命令定义
- ✅ `src/setting/settings.ts` - 设置页面（添加了语言选择器）
- ✅ `src/types.ts` - 类型定义（添加了语言设置）
- ✅ `src/constants.ts` - 默认设置（添加了默认语言）

### 5. 语言设置

在插件设置页面顶部添加了语言选择选项：
- 自动（跟随系统语言）
- English
- 简体中文

## 使用方法

### 对于用户

1. 安装或更新插件后，打开 Obsidian
2. 进入设置 → Obsidian Git
3. 在设置页面顶部选择您喜欢的语言
4. （可选）重新启动 Obsidian 以确保所有界面完全翻译

### 对于开发者

#### 使用翻译函数

```typescript
import { t } from "src/i18n";

// 基本用法
const message = t("notices.no-changes-to-commit");

// 带变量
const message = t("notices.pushed-files", {
    count: 5,
    file: "files"
});
```

#### 添加新的翻译键

1. 在 `src/i18n/locales/en.ts` 中添加英文翻译
2. 在 `src/i18n/locales/zh-cn.ts` 中添加中文翻译
3. 在代码中使用 `t("your.new.key")` 调用

## 翻译覆盖率

| 模块 | 翻译状态 | 说明 |
|------|---------|------|
| 命令名称 | ✅ 100% | 所有命令已翻译 |
| 通知消息 | ✅ 100% | 主要通知消息已翻译 |
| 设置页面 | ⚠️ 90% | 主要设置项已翻译，部分描述性文本仍为英文 |
| 对话框 | ✅ 100% | 主要对话框已翻译 |
| 文件菜单 | ✅ 100% | 上下文菜单项已翻译 |
| 状态栏 | ✅ 100% | 状态信息已翻译 |

## 待完成的工作

虽然核心功能已完全汉化，但以下部分仍需进一步优化：

1. **设置页面描述文本** - 一些详细的帮助文本仍使用英文，需要逐步翻译
2. **错误消息** - 部分技术性错误消息可能需要进一步本地化
3. **动态生成的文本** - 某些运行时生成的文本可能需要额外处理

## 技术细节

### 自动语言检测

系统会按以下优先级选择语言：
1. 用户在设置中明确选择的语言
2. 系统语言（通过 moment.locale() 检测）
3. 默认为英文

### 支持的语言代码

- `en` - English
- `zh-CN`, `zh-cn`, `zh` - 简体中文

## 贡献指南

欢迎贡献更多语言翻译！请参考 `src/i18n/README.md` 了解详细的贡献指南。

### 添加新语言的步骤

1. 在 `src/i18n/locales/` 下创建新的语言文件（如 `ja.ts`）
2. 参考 `en.ts` 或 `zh-cn.ts` 完成翻译
3. 在 `src/i18n/index.ts` 中注册新语言
4. 在 `src/setting/settings.ts` 的语言选择器中添加新选项
5. 提交 Pull Request

## 测试

建议测试以下场景：

- ✅ 切换语言后界面文本正确更新
- ✅ 命令面板中的命令名称已翻译
- ✅ 通知消息使用正确的语言
- ✅ 设置页面显示正确的语言
- ✅ 文件菜单项正确翻译
- ✅ 重启后保持语言设置

## 版本信息

- 基于版本: 2.36.1
- 汉化完成日期: 2026-01-20
- i18n 系统版本: 1.0.0

## 许可证

本汉化工作遵循与原项目相同的 MIT 许可证。

## 致谢

感谢原作者 Vinzent03 开发了这个优秀的 Obsidian Git 插件。

## 联系方式

如有问题或建议，请在 GitHub 仓库提交 Issue。
